<!DOCTYPE html>
<html>
  <head>
    <!--meta name="viewport" content="initial-scale=1.0, user-scalable=no"-->
    <meta charset="utf-8">
    <title>Marker Clustering</title>
    <style>
      #map {
        height: 600px;
        width: 1100px;
      }
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <body>
      <p id="message"></p>
        <div id="map"></div>
        <script>
            
            var mcOptions = {
                gridSize: 20,
                maxZoom: 15,
                styles: [{
                    height: 53,
                    url: "markr_1.png",
                    width: 53
                },
                {
                    height: 56,
                    url: "markr_2.png",
                    width: 56
                },
                {
                    height: 66,
                    url: "markr_3.png",
                    width: 66
                },
                {
                    height: 78,
                    url: "markr_4.png",
                    width: 78
                },
                {
                    height: 90,
                    url: "markr_5.png",
                    width: 90
                }] 
            };
            
            function callb(){
                $(document).ready(function() {

                $.ajax({

                  url : "stdsjson.php",
                  dataType : "JSON",
                  success : function(result) {
                    succ(result);
                  },
                    fail:function(){
                        alert("chart load fail");
                    }
                });
                });


                var start=[];
                var temp;

                function succ(result){

                    $.each(result, function(i,obj){

                    if(!Number.isInteger(parseFloat(obj.startLatitude))&&!Number.isInteger(parseFloat(obj.startLongitude)))
                     {
                         temp=new google.maps.LatLng(parseFloat(obj.startLatitude), parseFloat(obj.startLongitude));
                         start.push(temp);
                     }
                    });
                    initMap();
                }

              function initMap() {

                  document.getElementById("message").innerHTML="출발지 : RED";
                var map = new google.maps.Map(document.getElementById('map'), {
                  zoom: 7,
                  center: {lat: 36.322714, lng: 127.999915}
                });


                  var markers = start.map(function(location,i){
                      return new google.maps.Marker({
                    position: location
                  });
                  });

                var markerCluster = new MarkerClusterer(map, markers,mcOptions);
              }
            }
        </script>
    <script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js">
    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBgdDp3-ZOkGRRq1zekO9XcnDu_LHekzzU&callback=callb">
    </script>
  </body>
</html>